{"ast":null,"code":"var _jsxFileName = \"/Users/joshparry/sei/projects/marketplace-app-MERN-stack/marketplace-react-frontend/src/components/Sell.jsx\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport { Link } from 'react-router-dom';\nimport '../sell.css'; // upload an image\n// <h3>Welcome to the sell page</h3>\n// <form className=\"sell-form\">\n//   <label>Sell Item</label>\n//   <input type=\"text\" className=\"sell-input\"></input>\n//   <input type=\"submit\" className=\"sell-submit\" />\n// </form>\n\nlet labelArray = [];\n\nclass Sell extends Component {\n  constructor(props) {\n    super(props);\n\n    this.updateUserState = res => {\n      this.setState({\n        userId: res.data.user._id,\n        userName: res.data.user.name,\n        email: res.data.user.email\n      });\n    };\n\n    this.handleChange = e => {\n      console.log(e.target.files);\n      const file = e.target.files[0];\n      console.log({\n        file\n      }); // try upload\n\n      const fd = new FormData();\n      fd.append('file', file);\n      fd.append('upload_preset', 'rzxjcm4t');\n      console.log(fd); // fetch(url, {\n      //     method: 'POST',\n      //     body: formData\n      //   }).then(function (response) {\n      //      ...\n      //   });\n      // }\n\n      fetch('https://api.cloudinary.com/v1_1/dwjvh0hlj/image/upload', {\n        method: 'POST',\n        body: fd // config: { headers: { 'Content-Type': 'multipart/form-data'} }\n\n      }).then(res => res.json()).then(data => {\n        console.log('RESPONSE', data); // new ajax reqjuest to Node backend with data.data....public_id and labels seleceted\n\n        console.log(\"cloudinary UrL =  \".concat(data.url));\n        console.log(\"cloudinary UrL body =  \".concat(data.secure_url)); // this.setState({cloudinaryURL: })\n      });\n      var reader = new FileReader();\n      reader.addEventListener(\"load\", () => {\n        // preview.src = reader.result;\n        this.setState({\n          previewSrc: reader.result\n        }); // this.submitVisionApiRequest( reader.result );\n\n        const googleVision = this.submitVisionApiRequest(reader.result);\n        console.log(\"google vision is \".concat(googleVision));\n      }, false);\n\n      if (file) {\n        reader.readAsDataURL(file);\n      }\n    };\n\n    this.onLabelClick = e => {\n      e.preventDefault(); // console.log('The link was clicked.');\n\n      console.log(\"\".concat(e.target.value, \" was clicked\"));\n      labelArray.push(e.target.value);\n      this.setState({\n        selectedImageLabels: labelArray\n      });\n    };\n\n    this.itemNameChange = e => {\n      this.setState({\n        newItemName: e.target.value\n      });\n    };\n\n    this.priceChange = e => {\n      this.setState({\n        price: e.target.value\n      });\n    };\n\n    this.onNewItemSubmit = e => {\n      // <input type=\"text\" placeholder=\"Keywords\" value={this.state.selectedImageLabels}/>\n      e.preventDefault();\n      const authToken = localStorage.getItem('authToken');\n      let body = {\n        name: this.state.newItemName,\n        keywords: this.state.selectedImageLabels,\n        price: this.state.price,\n        seller: this.state.userId,\n        sellerName: this.state.userName\n      };\n      axios.post(\"http://localhost:4000/products/newsell\", body, {\n        headers: {\n          Authorization: \"Bearer \" + authToken\n        }\n      }).then(res => {\n        console.log('New Item submitted', res); // this.updateUserState( res );\n      }).catch(err => console.warn('SELL USER AJAX ERROR!', err)); // this.props.history.push({\n      //   pathname: '/products',\n      //   // search: '?query=abc',\n      //   state: { searchText: this.state.searchText }\n      // })\n    };\n\n    this.state = {\n      userName: '',\n      userId: '',\n      email: '',\n      previewSrc: '',\n      imageText: '',\n      imageLabels: [],\n      selectedImageLabels: [],\n      newItemName: '',\n      price: '',\n      cloudinaryURL: ''\n    };\n  }\n\n  componentDidMount() {\n    console.log(\"Local storage is: \".concat(localStorage.getItem('authToken'))); // Find out info about the user of the current JWT token\n\n    const authToken = localStorage.getItem('authToken'); // axios.post('http://localhost:4000/products/identifyseller',{\n    //   headers: {\n    //       Authorization: \"Bearer \" + authToken,\n    //   }\n    // }\n    // )\n    // axios.get('http://localhost:4000/products/identifyseller')\n\n    axios.get('http://localhost:4000/products/identifyseller', {\n      headers: {\n        Authorization: \"Bearer \" + authToken\n      }\n    }).then(res => {\n      console.log('GOT USER', res);\n      this.updateUserState(res);\n    }).catch(err => console.warn('SELL USER AJAX ERROR!', err));\n  } // Method to update the state to users info\n\n\n  // handleChange()\n  submitVisionApiRequest(base64Data) {\n    base64Data = base64Data.replace('data:image/jpeg;base64,', '');\n    let body = {\n      \"requests\": [{\n        \"image\": {\n          \"content\": base64Data\n        },\n        \"features\": [{\n          \"type\": \"LABEL_DETECTION\",\n          \"maxResults\": 10\n        }, {\n          \"type\": \"TEXT_DETECTION\",\n          \"maxResults\": 4\n        }]\n      }]\n    }; // axios.post('http://localhost:4000/login', {\n    //   email:   this.state.email,\n    //   password: this.state.password\n    // })\n    // axios.post('https://vision.googleapis.com/v1/images:annotate?key=AIzaSyAcAWwGwIs7iNyPB5OdnCEG33wbJP8Re3s', {\n    //   Authorization: ''\n    // })\n\n    axios.post('https://vision.googleapis.com/v1/images:annotate?key=AIzaSyAcAWwGwIs7iNyPB5OdnCEG33wbJP8Re3s', body) // fetch({\n    //    method: 'POST',\n    //    url: 'https://vision.googleapis.com/v1/images:annotate?key=AIzaSyAcAWwGwIs7iNyPB5OdnCEG33wbJP8Re3s',\n    //    body: body\n    //  })\n    // .then((response) => console.log('google cloud vision response', response.body))\n    // .then(res => console.log('google cloud vision response', res))\n    .then(res => {\n      const visionArray = res.data.responses[0].labelAnnotations;\n      const visionLabelArray = [];\n      const imageLables = visionArray.map(l => {\n        visionLabelArray.push(l.description);\n      });\n      console.log(\"visionLabelArray is: \".concat(visionLabelArray));\n      this.setState({\n        imageLabels: visionLabelArray\n      });\n      console.log('Google Vision', res.data.responses[0].fullTextAnnotation.text);\n      this.setState({\n        imageText: res.data.responses[0].fullTextAnnotation.text\n      });\n      return res;\n    }).catch(err => console.warn('Google Cloud Vision error!', err)); // fetch(\n    //   'https://vision.googleapis.com/v1/images:annotate?key=AIzaSyAcAWwGwIs7iNyPB5OdnCEG33wbJP8Re3s',\n    //   body\n    // )\n    // .then((response) => console.log(response));\n  } // end of handle api change\n  // googleVision(base64Data){\n  //   const vision = require('react-cloud-vision-api')\n  //   vision.init({auth: 'AIzaSyAcAWwGwIs7iNyPB5OdnCEG33wbJP8Re3s'})\n  //   const req = new vision.Request({\n  //     image: new vision.Image({\n  //       base64: base64Data,\n  //     }),\n  //     features: [\n  //       new vision.Feature('TEXT_DETECTION', 4),\n  //       new vision.Feature('LABEL_DETECTION', 10),\n  //     ]\n  //   })\n  //\n  //   return req\n  // }\n\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254\n      },\n      __self: this\n    }, React.createElement(\"nav\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255\n      },\n      __self: this\n    }, React.createElement(\"ul\", {\n      className: \"nav-list\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256\n      },\n      __self: this\n    }, React.createElement(\"li\", {\n      className: \"nav-item-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"nav-item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: \"/\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257\n      },\n      __self: this\n    }, \"Home\"))), React.createElement(\"li\", {\n      className: \"nav-item-right\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 258\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"nav-item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 258\n      },\n      __self: this\n    }, \"Cart\")), React.createElement(\"li\", {\n      className: \"nav-item-right\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"nav-item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: \"/sell\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259\n      },\n      __self: this\n    }, \"Sell\"))), React.createElement(\"li\", {\n      className: \"nav-item-right\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"nav-item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: \"/signup\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260\n      },\n      __self: this\n    }, \"Signup\"))), React.createElement(\"li\", {\n      className: \"nav-item-right\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 261\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"nav-item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 261\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: \"/login\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 261\n      },\n      __self: this\n    }, \"Login\"))))), this.state.previewSrc && React.createElement(\"img\", {\n      className: \"preview\",\n      src: this.state.previewSrc,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 269\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      type: \"file\",\n      onChange: this.handleChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 272\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"all-labels\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 275\n      },\n      __self: this\n    }, this.state.imageLabels.length > 0 ? this.state.imageLabels.map(p => React.createElement(\"div\", {\n      className: \"labels\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      key: \"label-\".concat(p),\n      className: \"label-button\",\n      onClick: this.onLabelClick,\n      value: p,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 281\n      },\n      __self: this\n    }, p))) : React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 287\n      },\n      __self: this\n    })), React.createElement(\"form\", {\n      className: \"sell-new-item-form\",\n      onSubmit: this.onNewItemSubmit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 292\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"text\",\n      placeholder: \"Name\",\n      value: this.state.userName,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      type: \"text\",\n      placeholder: \"Item Name\",\n      onChange: this.itemNameChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 294\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      type: \"text\",\n      placeholder: \"Price ($)\",\n      onChange: this.priceChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 296\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      type: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 297\n      },\n      __self: this\n    })));\n  }\n\n}\n\nexport default Sell;","map":{"version":3,"sources":["/Users/joshparry/sei/projects/marketplace-app-MERN-stack/marketplace-react-frontend/src/components/Sell.jsx"],"names":["React","Component","axios","Link","labelArray","Sell","constructor","props","updateUserState","res","setState","userId","data","user","_id","userName","name","email","handleChange","e","console","log","target","files","file","fd","FormData","append","fetch","method","body","then","json","url","secure_url","reader","FileReader","addEventListener","previewSrc","result","googleVision","submitVisionApiRequest","readAsDataURL","onLabelClick","preventDefault","value","push","selectedImageLabels","itemNameChange","newItemName","priceChange","price","onNewItemSubmit","authToken","localStorage","getItem","state","keywords","seller","sellerName","post","headers","Authorization","catch","err","warn","imageText","imageLabels","cloudinaryURL","componentDidMount","get","base64Data","replace","visionArray","responses","labelAnnotations","visionLabelArray","imageLables","map","l","description","fullTextAnnotation","text","render","length","p"],"mappings":"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","sourcesContent":["\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport { Link } from 'react-router-dom';\nimport '../sell.css'\n\n// upload an image\n\n// <h3>Welcome to the sell page</h3>\n// <form className=\"sell-form\">\n//   <label>Sell Item</label>\n//   <input type=\"text\" className=\"sell-input\"></input>\n//   <input type=\"submit\" className=\"sell-submit\" />\n// </form>\n\nlet labelArray = []\n\nclass Sell extends Component {\n\n  constructor(props){\n    super(props);\n    this.state = {\n      userName: '',\n      userId: '',\n      email: '',\n      previewSrc: '',\n      imageText: '',\n      imageLabels: [],\n      selectedImageLabels: [],\n      newItemName: '',\n      price: '',\n      cloudinaryURL: ''\n    }\n  }\n\n  componentDidMount(){\n    console.log(`Local storage is: ${localStorage.getItem('authToken')}`);\n\n    // Find out info about the user of the current JWT token\n    const authToken = localStorage.getItem('authToken');\n    // axios.post('http://localhost:4000/products/identifyseller',{\n    //   headers: {\n    //       Authorization: \"Bearer \" + authToken,\n    //   }\n    // }\n    // )\n\n    // axios.get('http://localhost:4000/products/identifyseller')\n\n    axios.get('http://localhost:4000/products/identifyseller', {\n      headers: {\n        Authorization: \"Bearer \" + authToken\n      }\n    })\n    .then( res => {\n      console.log('GOT USER', res);\n      this.updateUserState( res );\n    })\n    .catch(err => console.warn('SELL USER AJAX ERROR!', err) );\n\n  }\n\n  // Method to update the state to users info\n  updateUserState = (res) => {\n    this.setState({userId: res.data.user._id, userName: res.data.user.name, email: res.data.user.email })\n  }\n\n  handleChange = (e) => {\n    console.log(e.target.files);\n    const file = e.target.files[0];\n    console.log({file});\n\n    // try upload\n    const fd = new FormData();\n    fd.append('file', file );\n    fd.append('upload_preset', 'rzxjcm4t');\n    console.log( fd );\n\n\n    // fetch(url, {\n    //     method: 'POST',\n    //     body: formData\n    //   }).then(function (response) {\n    //      ...\n    //   });\n    // }\n\n    fetch('https://api.cloudinary.com/v1_1/dwjvh0hlj/image/upload', {\n      method: 'POST',\n      body: fd,\n      // config: { headers: { 'Content-Type': 'multipart/form-data'} }\n    })\n    .then( res => res.json() )\n    .then( data => {\n      console.log('RESPONSE', data)\n      // new ajax reqjuest to Node backend with data.data....public_id and labels seleceted\n      console.log(`cloudinary UrL =  ${data.url}`);\n      console.log(`cloudinary UrL body =  ${data.secure_url}`);\n      // this.setState({cloudinaryURL: })\n    });\n\n\n    var reader  = new FileReader();\n\n    reader.addEventListener(\"load\", () => {\n      // preview.src = reader.result;\n      this.setState({ previewSrc: reader.result });\n      // this.submitVisionApiRequest( reader.result );\n      const googleVision = this.submitVisionApiRequest( reader.result );\n      console.log(`google vision is ${googleVision}`);\n\n    }, false);\n\n    if (file) {\n      reader.readAsDataURL(file);\n    }\n\n  } // handleChange()\n\n  submitVisionApiRequest(base64Data){\n  base64Data = base64Data.replace('data:image/jpeg;base64,', '');\n  let body = {\n    \"requests\": [\n      {\n        \"image\": {\n          \"content\": base64Data,\n        },\n        \"features\": [\n          {\n            \"type\": \"LABEL_DETECTION\",\n            \"maxResults\": 10\n          },\n          {\n            \"type\": \"TEXT_DETECTION\",\n            \"maxResults\": 4\n          }\n        ]\n      }\n    ]\n  };\n\n  // axios.post('http://localhost:4000/login', {\n  //   email:   this.state.email,\n  //   password: this.state.password\n  // })\n  // axios.post('https://vision.googleapis.com/v1/images:annotate?key=AIzaSyAcAWwGwIs7iNyPB5OdnCEG33wbJP8Re3s', {\n  //   Authorization: ''\n  // })\n\n  axios.post(\n    'https://vision.googleapis.com/v1/images:annotate?key=AIzaSyAcAWwGwIs7iNyPB5OdnCEG33wbJP8Re3s',\n    body\n  )\n\n  // fetch({\n  //    method: 'POST',\n  //    url: 'https://vision.googleapis.com/v1/images:annotate?key=AIzaSyAcAWwGwIs7iNyPB5OdnCEG33wbJP8Re3s',\n  //    body: body\n  //  })\n   // .then((response) => console.log('google cloud vision response', response.body))\n   // .then(res => console.log('google cloud vision response', res))\n   .then( res => {\n\n     const visionArray = res.data.responses[0].labelAnnotations;\n     const visionLabelArray = []\n     const imageLables = visionArray.map( l => {\n       visionLabelArray.push(l.description)\n     })\n     console.log(`visionLabelArray is: ${visionLabelArray}`);\n     this.setState({ imageLabels: visionLabelArray})\n\n     console.log('Google Vision', res.data.responses[0].fullTextAnnotation.text)\n     this.setState({ imageText: res.data.responses[0].fullTextAnnotation.text})\n     return res\n\n   })\n   .catch(err => console.warn('Google Cloud Vision error!', err) );\n  // fetch(\n  //   'https://vision.googleapis.com/v1/images:annotate?key=AIzaSyAcAWwGwIs7iNyPB5OdnCEG33wbJP8Re3s',\n  //   body\n  // )\n  // .then((response) => console.log(response));\n\n} // end of handle api change\n\n// googleVision(base64Data){\n//   const vision = require('react-cloud-vision-api')\n//   vision.init({auth: 'AIzaSyAcAWwGwIs7iNyPB5OdnCEG33wbJP8Re3s'})\n//   const req = new vision.Request({\n//     image: new vision.Image({\n//       base64: base64Data,\n//     }),\n//     features: [\n//       new vision.Feature('TEXT_DETECTION', 4),\n//       new vision.Feature('LABEL_DETECTION', 10),\n//     ]\n//   })\n//\n//   return req\n// }\n\nonLabelClick = (e) => {\n  e.preventDefault();\n  // console.log('The link was clicked.');\n  console.log(`${e.target.value} was clicked`);\n\n  labelArray.push(e.target.value)\n\n  this.setState({selectedImageLabels: labelArray})\n}\n\nitemNameChange = (e) => {\n  this.setState({newItemName: e.target.value})\n}\n\npriceChange = (e) => {\n  this.setState({price: e.target.value})\n}\n\n\nonNewItemSubmit = (e) => {\n\n          // <input type=\"text\" placeholder=\"Keywords\" value={this.state.selectedImageLabels}/>\n  e.preventDefault();\n  const authToken = localStorage.getItem('authToken');\n\n  let body = {\n    name: this.state.newItemName,\n    keywords: this.state.selectedImageLabels,\n    price: this.state.price,\n    seller: this.state.userId,\n    sellerName: this.state.userName\n  }\n\n  axios.post(\"http://localhost:4000/products/newsell\", body, {\n    headers: { Authorization: \"Bearer \" + authToken }\n  })\n  .then( res => {\n    console.log('New Item submitted', res);\n    // this.updateUserState( res );\n  })\n  .catch(err => console.warn('SELL USER AJAX ERROR!', err) );\n\n  // this.props.history.push({\n  //   pathname: '/products',\n  //   // search: '?query=abc',\n  //   state: { searchText: this.state.searchText }\n  // })\n}\n\n\n  render() {\n    return(\n      <div>\n        <nav>\n          <ul className=\"nav-list\">\n            <li className=\"nav-item-left\"><div className=\"nav-item\"><Link to=\"/\">Home</Link></div></li>\n            <li className=\"nav-item-right\"><div className=\"nav-item\">Cart</div></li>\n            <li className=\"nav-item-right\"><div className=\"nav-item\"><Link to=\"/sell\">Sell</Link></div></li>\n            <li className=\"nav-item-right\"><div className=\"nav-item\"><Link to=\"/signup\">Signup</Link></div></li>\n            <li className=\"nav-item-right\"><div className=\"nav-item\"><Link to=\"/login\">Login</Link></div></li>\n          </ul>\n        </nav>\n\n\n\n\n      {\n        this.state.previewSrc && <img className=\"preview\" src={this.state.previewSrc} />\n      }\n\n      <input type=\"file\" onChange={this.handleChange}/>\n\n\n        <div className=\"all-labels\">\n          {\n            this.state.imageLabels.length > 0\n            ?\n            this.state.imageLabels.map( p =>\n                <div className='labels'>\n                  <button key={`label-${p}`} className='label-button' onClick={this.onLabelClick} value={p}>\n                    {p}\n                  </button>\n                </div>\n            )\n            :\n           <p></p>\n          }\n        </div>\n\n\n      <form className=\"sell-new-item-form\" onSubmit={this.onNewItemSubmit}>\n        <input type=\"text\" placeholder=\"Name\" value={this.state.userName}/>\n        <input type=\"text\" placeholder=\"Item Name\" onChange={this.itemNameChange} />\n\n        <input type=\"text\" placeholder=\"Price ($)\" onChange={this.priceChange}/>\n        <input type=\"submit\" />\n      </form>\n\n      </div>\n    )\n  }\n}\n\nexport default Sell\n"]},"metadata":{},"sourceType":"module"}