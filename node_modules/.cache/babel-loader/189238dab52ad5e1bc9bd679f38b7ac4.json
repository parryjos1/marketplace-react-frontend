{"ast":null,"code":"var _jsxFileName = \"/Users/joshparry/sei/projects/marketplace-app-MERN-stack/marketplace-react-frontend/src/components/Sell.jsx\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport { Link } from 'react-router-dom';\nimport '../sell.css'; // upload an image\n// <h3>Welcome to the sell page</h3>\n// <form className=\"sell-form\">\n//   <label>Sell Item</label>\n//   <input type=\"text\" className=\"sell-input\"></input>\n//   <input type=\"submit\" className=\"sell-submit\" />\n// </form>\n\nlet labelArray = [];\n\nclass Sell extends Component {\n  constructor(props) {\n    super(props);\n\n    this.updateUserState = res => {\n      this.setState({\n        userId: res.data.user._id,\n        userName: res.data.user.name,\n        email: res.data.user.email\n      });\n    };\n\n    this.handleChange = e => {\n      console.log(e.target.files);\n      const file = e.target.files[0];\n      console.log({\n        file\n      }); // try upload\n\n      const fd = new FormData();\n      fd.append('file', file);\n      fd.append('upload_preset', 'rzxjcm4t');\n      console.log(fd);\n      fetch({\n        method: 'post',\n        url: 'https://api.cloudinary.com/v1_1/dwjvh0hlj/image/upload',\n        data: fd,\n        config: {\n          headers: {\n            'Content-Type': 'multipart/form-data'\n          }\n        }\n      }).then(res => {\n        console.log('RESPONSE', res); // new ajax reqjuest to Node backend with res.data....public_id and labels seleceted\n      });\n      var reader = new FileReader();\n      reader.addEventListener(\"load\", () => {\n        // preview.src = reader.result;\n        this.setState({\n          previewSrc: reader.result\n        }); // this.submitVisionApiRequest( reader.result );\n\n        const googleVision = this.submitVisionApiRequest(reader.result);\n        console.log(\"google vision is \".concat(googleVision));\n      }, false);\n\n      if (file) {\n        reader.readAsDataURL(file);\n      }\n    };\n\n    this.onLabelClick = e => {\n      e.preventDefault(); // console.log('The link was clicked.');\n\n      console.log(\"\".concat(e.target.value, \" was clicked\"));\n      labelArray.push(e.target.value);\n      this.setState({\n        selectedImageLabels: labelArray\n      });\n    };\n\n    this.itemNameChange = e => {\n      this.setState({\n        newItemName: e.target.value\n      });\n    };\n\n    this.onNewItemSubmit = e => {\n      e.preventDefault();\n      const authToken = localStorage.getItem('authToken'); // let body = {\n      //   name: ,\n      //   keywords: ,\n      //   price: ,\n      //   seller:\n      // }\n      //axios request to add a new image\n\n      axios.post('http://localhost:4000/products/identifyseller', {\n        headers: {\n          Authorization: \"Bearer \" + authToken\n        }\n      }).then(res => {\n        console.log('GOT USER', res);\n        this.updateUserState(res);\n      }).catch(err => console.warn('SELL USER AJAX ERROR!', err)); // this.props.history.push({\n      //   pathname: '/products',\n      //   // search: '?query=abc',\n      //   state: { searchText: this.state.searchText }\n      // })\n    };\n\n    this.state = {\n      userName: '',\n      userId: '',\n      email: '',\n      previewSrc: '',\n      imageText: '',\n      imageLabels: [],\n      selectedImageLabels: [],\n      newItemName: '',\n      price: ''\n    };\n  }\n\n  componentDidMount() {\n    console.log(\"Local storage is: \".concat(localStorage.getItem('authToken'))); // Find out info about the user of the current JWT token\n\n    const authToken = localStorage.getItem('authToken'); // axios.post('http://localhost:4000/products/identifyseller',{\n    //   headers: {\n    //       Authorization: \"Bearer \" + authToken,\n    //   }\n    // }\n    // )\n    // axios.get('http://localhost:4000/products/identifyseller')\n\n    axios.get('http://localhost:4000/products/identifyseller', {\n      headers: {\n        Authorization: \"Bearer \" + authToken\n      }\n    }).then(res => {\n      console.log('GOT USER', res);\n      this.updateUserState(res);\n    }).catch(err => console.warn('SELL USER AJAX ERROR!', err));\n  } // Method to update the state to users info\n\n\n  // handleChange()\n  submitVisionApiRequest(base64Data) {\n    base64Data = base64Data.replace('data:image/jpeg;base64,', '');\n    let body = {\n      \"requests\": [{\n        \"image\": {\n          \"content\": base64Data\n        },\n        \"features\": [{\n          \"type\": \"LABEL_DETECTION\",\n          \"maxResults\": 10\n        }, {\n          \"type\": \"TEXT_DETECTION\",\n          \"maxResults\": 4\n        }]\n      }]\n    }; // axios.post('http://localhost:4000/login', {\n    //   email:   this.state.email,\n    //   password: this.state.password\n    // })\n    // axios.post('https://vision.googleapis.com/v1/images:annotate?key=AIzaSyAcAWwGwIs7iNyPB5OdnCEG33wbJP8Re3s', {\n    //   Authorization: ''\n    // })\n\n    axios.post('https://vision.googleapis.com/v1/images:annotate?key=AIzaSyAcAWwGwIs7iNyPB5OdnCEG33wbJP8Re3s', body) // fetch({\n    //    method: 'POST',\n    //    url: 'https://vision.googleapis.com/v1/images:annotate?key=AIzaSyAcAWwGwIs7iNyPB5OdnCEG33wbJP8Re3s',\n    //    body: body\n    //  })\n    // .then((response) => console.log('google cloud vision response', response.body))\n    // .then(res => console.log('google cloud vision response', res))\n    .then(res => {\n      console.log('Google Vision', res.data.responses[0].fullTextAnnotation.text);\n      this.setState({\n        imageText: res.data.responses[0].fullTextAnnotation.text\n      });\n      const visionArray = res.data.responses[0].labelAnnotations;\n      const visionLabelArray = [];\n      const imageLables = visionArray.map(l => {\n        visionLabelArray.push(l.description);\n      });\n      console.log(\"visionLabelArray is: \".concat(visionLabelArray));\n      this.setState({\n        imageLabels: visionLabelArray\n      });\n      return res;\n    }).catch(err => console.warn('Google Cloud Vision error!', err)); // fetch(\n    //   'https://vision.googleapis.com/v1/images:annotate?key=AIzaSyAcAWwGwIs7iNyPB5OdnCEG33wbJP8Re3s',\n    //   body\n    // )\n    // .then((response) => console.log(response));\n  } // end of handle api change\n  // googleVision(base64Data){\n  //   const vision = require('react-cloud-vision-api')\n  //   vision.init({auth: 'AIzaSyAcAWwGwIs7iNyPB5OdnCEG33wbJP8Re3s'})\n  //   const req = new vision.Request({\n  //     image: new vision.Image({\n  //       base64: base64Data,\n  //     }),\n  //     features: [\n  //       new vision.Feature('TEXT_DETECTION', 4),\n  //       new vision.Feature('LABEL_DETECTION', 10),\n  //     ]\n  //   })\n  //\n  //   return req\n  // }\n\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238\n      },\n      __self: this\n    }, React.createElement(\"nav\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 239\n      },\n      __self: this\n    }, React.createElement(\"ul\", {\n      className: \"nav-list\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 240\n      },\n      __self: this\n    }, React.createElement(\"li\", {\n      className: \"nav-item-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 241\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"nav-item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 241\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: \"/\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 241\n      },\n      __self: this\n    }, \"Home\"))), React.createElement(\"li\", {\n      className: \"nav-item-right\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"nav-item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242\n      },\n      __self: this\n    }, \"Cart\")), React.createElement(\"li\", {\n      className: \"nav-item-right\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"nav-item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: \"/sell\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243\n      },\n      __self: this\n    }, \"Sell\"))), React.createElement(\"li\", {\n      className: \"nav-item-right\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"nav-item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: \"/signup\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244\n      },\n      __self: this\n    }, \"Signup\"))), React.createElement(\"li\", {\n      className: \"nav-item-right\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"nav-item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: \"/login\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245\n      },\n      __self: this\n    }, \"Login\"))))), this.state.previewSrc && React.createElement(\"img\", {\n      className: \"preview\",\n      src: this.state.previewSrc,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 253\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      type: \"file\",\n      onChange: this.handleChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"all-labels\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259\n      },\n      __self: this\n    }, this.state.imageLabels.length > 0 ? this.state.imageLabels.map(p => React.createElement(\"div\", {\n      className: \"labels\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 264\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      key: \"label-\".concat(p),\n      className: \"label-button\",\n      onClick: this.onLabelClick,\n      value: p,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 265\n      },\n      __self: this\n    }, p))) : React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 271\n      },\n      __self: this\n    })), React.createElement(\"form\", {\n      className: \"sell-new-item-form\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 276\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"text\",\n      placeholder: \"Name\",\n      value: this.state.userName,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 277\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      type: \"text\",\n      placeholder: \"Item Name\",\n      onChange: this.itemNameChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 278\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      type: \"text\",\n      placeholder: \"Keywords\",\n      value: this.state.selectedImageLabels,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 279\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      type: \"text\",\n      placeholder: \"Add anymore Keywords\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      type: \"text\",\n      placeholder: \"Price ($)\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 281\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      type: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 282\n      },\n      __self: this\n    })));\n  }\n\n}\n\nexport default Sell;","map":{"version":3,"sources":["/Users/joshparry/sei/projects/marketplace-app-MERN-stack/marketplace-react-frontend/src/components/Sell.jsx"],"names":["React","Component","axios","Link","labelArray","Sell","constructor","props","updateUserState","res","setState","userId","data","user","_id","userName","name","email","handleChange","e","console","log","target","files","file","fd","FormData","append","fetch","method","url","config","headers","then","reader","FileReader","addEventListener","previewSrc","result","googleVision","submitVisionApiRequest","readAsDataURL","onLabelClick","preventDefault","value","push","selectedImageLabels","itemNameChange","newItemName","onNewItemSubmit","authToken","localStorage","getItem","post","Authorization","catch","err","warn","state","imageText","imageLabels","price","componentDidMount","get","base64Data","replace","body","responses","fullTextAnnotation","text","visionArray","labelAnnotations","visionLabelArray","imageLables","map","l","description","render","length","p"],"mappings":"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","sourcesContent":["\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport { Link } from 'react-router-dom';\nimport '../sell.css'\n\n// upload an image\n\n// <h3>Welcome to the sell page</h3>\n// <form className=\"sell-form\">\n//   <label>Sell Item</label>\n//   <input type=\"text\" className=\"sell-input\"></input>\n//   <input type=\"submit\" className=\"sell-submit\" />\n// </form>\n\nlet labelArray = []\n\nclass Sell extends Component {\n\n  constructor(props){\n    super(props);\n    this.state = {\n      userName: '',\n      userId: '',\n      email: '',\n      previewSrc: '',\n      imageText: '',\n      imageLabels: [],\n      selectedImageLabels: [],\n      newItemName: '',\n      price: ''\n    }\n  }\n\n  componentDidMount(){\n    console.log(`Local storage is: ${localStorage.getItem('authToken')}`);\n\n    // Find out info about the user of the current JWT token\n    const authToken = localStorage.getItem('authToken');\n    // axios.post('http://localhost:4000/products/identifyseller',{\n    //   headers: {\n    //       Authorization: \"Bearer \" + authToken,\n    //   }\n    // }\n    // )\n\n    // axios.get('http://localhost:4000/products/identifyseller')\n\n    axios.get('http://localhost:4000/products/identifyseller', {\n      headers: {\n        Authorization: \"Bearer \" + authToken\n      }\n    })\n    .then( res => {\n      console.log('GOT USER', res);\n      this.updateUserState( res );\n    })\n    .catch(err => console.warn('SELL USER AJAX ERROR!', err) );\n\n  }\n\n  // Method to update the state to users info\n  updateUserState = (res) => {\n    this.setState({userId: res.data.user._id, userName: res.data.user.name, email: res.data.user.email })\n  }\n\n  handleChange = (e) => {\n    console.log(e.target.files);\n    const file = e.target.files[0];\n    console.log({file});\n\n    // try upload\n    const fd = new FormData();\n    fd.append('file', file );\n    fd.append('upload_preset', 'rzxjcm4t');\n    console.log( fd );\n\n    fetch({\n      method: 'post',\n      url: 'https://api.cloudinary.com/v1_1/dwjvh0hlj/image/upload',\n      data: fd,\n      config: { headers: { 'Content-Type': 'multipart/form-data'} }\n    })\n    .then( res => {\n      console.log('RESPONSE', res)\n      // new ajax reqjuest to Node backend with res.data....public_id and labels seleceted\n    });\n\n\n    var reader  = new FileReader();\n\n    reader.addEventListener(\"load\", () => {\n      // preview.src = reader.result;\n      this.setState({ previewSrc: reader.result });\n      // this.submitVisionApiRequest( reader.result );\n      const googleVision = this.submitVisionApiRequest( reader.result );\n      console.log(`google vision is ${googleVision}`);\n\n    }, false);\n\n    if (file) {\n      reader.readAsDataURL(file);\n    }\n\n  } // handleChange()\n\n  submitVisionApiRequest(base64Data){\n  base64Data = base64Data.replace('data:image/jpeg;base64,', '');\n  let body = {\n    \"requests\": [\n      {\n        \"image\": {\n          \"content\": base64Data,\n        },\n        \"features\": [\n          {\n            \"type\": \"LABEL_DETECTION\",\n            \"maxResults\": 10\n          },\n          {\n            \"type\": \"TEXT_DETECTION\",\n            \"maxResults\": 4\n          }\n        ]\n      }\n    ]\n  };\n\n  // axios.post('http://localhost:4000/login', {\n  //   email:   this.state.email,\n  //   password: this.state.password\n  // })\n  // axios.post('https://vision.googleapis.com/v1/images:annotate?key=AIzaSyAcAWwGwIs7iNyPB5OdnCEG33wbJP8Re3s', {\n  //   Authorization: ''\n  // })\n\n  axios.post(\n    'https://vision.googleapis.com/v1/images:annotate?key=AIzaSyAcAWwGwIs7iNyPB5OdnCEG33wbJP8Re3s',\n    body\n  )\n\n  // fetch({\n  //    method: 'POST',\n  //    url: 'https://vision.googleapis.com/v1/images:annotate?key=AIzaSyAcAWwGwIs7iNyPB5OdnCEG33wbJP8Re3s',\n  //    body: body\n  //  })\n   // .then((response) => console.log('google cloud vision response', response.body))\n   // .then(res => console.log('google cloud vision response', res))\n   .then( res => {\n     console.log('Google Vision', res.data.responses[0].fullTextAnnotation.text)\n     this.setState({ imageText: res.data.responses[0].fullTextAnnotation.text})\n\n     const visionArray = res.data.responses[0].labelAnnotations;\n     const visionLabelArray = []\n     const imageLables = visionArray.map( l => {\n       visionLabelArray.push(l.description)\n     })\n     console.log(`visionLabelArray is: ${visionLabelArray}`);\n     this.setState({ imageLabels: visionLabelArray})\n\n     return res\n\n   })\n   .catch(err => console.warn('Google Cloud Vision error!', err) );\n  // fetch(\n  //   'https://vision.googleapis.com/v1/images:annotate?key=AIzaSyAcAWwGwIs7iNyPB5OdnCEG33wbJP8Re3s',\n  //   body\n  // )\n  // .then((response) => console.log(response));\n\n} // end of handle api change\n\n// googleVision(base64Data){\n//   const vision = require('react-cloud-vision-api')\n//   vision.init({auth: 'AIzaSyAcAWwGwIs7iNyPB5OdnCEG33wbJP8Re3s'})\n//   const req = new vision.Request({\n//     image: new vision.Image({\n//       base64: base64Data,\n//     }),\n//     features: [\n//       new vision.Feature('TEXT_DETECTION', 4),\n//       new vision.Feature('LABEL_DETECTION', 10),\n//     ]\n//   })\n//\n//   return req\n// }\n\nonLabelClick = (e) => {\n  e.preventDefault();\n  // console.log('The link was clicked.');\n  console.log(`${e.target.value} was clicked`);\n\n  labelArray.push(e.target.value)\n\n  this.setState({selectedImageLabels: labelArray})\n}\n\nitemNameChange = (e) => {\n  this.setState({newItemName: e.target.value})\n}\n\n\nonNewItemSubmit = (e) => {\n  e.preventDefault();\n  const authToken = localStorage.getItem('authToken');\n\n  // let body = {\n  //   name: ,\n  //   keywords: ,\n  //   price: ,\n  //   seller:\n  // }\n\n  //axios request to add a new image\n  axios.post('http://localhost:4000/products/identifyseller', {\n    headers: {\n      Authorization: \"Bearer \" + authToken\n    }\n  })\n  .then( res => {\n    console.log('GOT USER', res);\n    this.updateUserState( res );\n  })\n  .catch(err => console.warn('SELL USER AJAX ERROR!', err) );\n\n\n  // this.props.history.push({\n  //   pathname: '/products',\n  //   // search: '?query=abc',\n  //   state: { searchText: this.state.searchText }\n  // })\n}\n\n\n  render() {\n    return(\n      <div>\n        <nav>\n          <ul className=\"nav-list\">\n            <li className=\"nav-item-left\"><div className=\"nav-item\"><Link to=\"/\">Home</Link></div></li>\n            <li className=\"nav-item-right\"><div className=\"nav-item\">Cart</div></li>\n            <li className=\"nav-item-right\"><div className=\"nav-item\"><Link to=\"/sell\">Sell</Link></div></li>\n            <li className=\"nav-item-right\"><div className=\"nav-item\"><Link to=\"/signup\">Signup</Link></div></li>\n            <li className=\"nav-item-right\"><div className=\"nav-item\"><Link to=\"/login\">Login</Link></div></li>\n          </ul>\n        </nav>\n\n\n\n\n      {\n        this.state.previewSrc && <img className=\"preview\" src={this.state.previewSrc} />\n      }\n\n      <input type=\"file\" onChange={this.handleChange}/>\n\n\n        <div className=\"all-labels\">\n          {\n            this.state.imageLabels.length > 0\n            ?\n            this.state.imageLabels.map( p =>\n                <div className='labels'>\n                  <button key={`label-${p}`} className='label-button' onClick={this.onLabelClick} value={p}>\n                    {p}\n                  </button>\n                </div>\n            )\n            :\n           <p></p>\n          }\n        </div>\n\n\n      <form className=\"sell-new-item-form\">\n        <input type=\"text\" placeholder=\"Name\" value={this.state.userName}/>\n        <input type=\"text\" placeholder=\"Item Name\" onChange={this.itemNameChange} />\n        <input type=\"text\" placeholder=\"Keywords\" value={this.state.selectedImageLabels}/>\n        <input type=\"text\" placeholder=\"Add anymore Keywords\"/>\n        <input type=\"text\" placeholder=\"Price ($)\"/>\n        <input type=\"submit\" />\n      </form>\n\n      </div>\n    )\n  }\n}\n\nexport default Sell\n"]},"metadata":{},"sourceType":"module"}